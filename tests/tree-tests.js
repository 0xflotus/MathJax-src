import {JsonVisitor} from 'TreeJax/lib/json_visitor';
import {Tree} from 'TreeJax/lib/tree';

import {Test} from './tests.js';


class TreeTest extends Test {

  constructor() {
    super();
  }

  // Tests exclusively the timing of the Translate method.
  runTest(name, expected) {
    this.test(
      name,
      t => {
        let tree = Tree.parse(expected);
        let jv = new JsonVisitor();
        tree.accept(jv);
        t.deepEqual(jv.getResult(), expected, name);
      });
  }

}

let treeTest = new TreeTest();

treeTest.runTest(
  'Identifier',
  {'type':'math',
   'children':[
     {'type':'mrow',
      'inferred':true,
      'children':[
        {'type':'mi',
         'text':'x',
         'attributes':{}}],
      'attributes':{}}],
   'attributes':{'display':'block'}
  }
);


treeTest.runTest(
  'Two Identifiers',
  {'type':'math',
   'children':[
     {'type':'mrow',
      'inferred':true,
      'children':[
        {'type':'mi',
         'text':'x',
         'attributes':{}},
        {'type':'mi',
         'text':'y',
         'attributes':{}}],
      'attributes':{}}],
   'attributes':{'display':'block'}
  }
);


treeTest.runTest(
  'Number',
  {'type':'math',
   'children':[
     {'type':'mrow',
      'inferred':true,
      'children':[
        {'type':'mn',
         'text':'2',
         'attributes':{}}],
      'attributes':{}}],
   'attributes':{'display':'block'}
  }
);


treeTest.runTest(
  'Square',
  {'type':'math',
   'children':[
           {'type':'mrow',
            'inferred':true,
            'children':[
              {'type':'msup',
               'children':[
                 {'type':'mi',
                  'text':'x',
                  'attributes':{}},
                 {'type':'mn',
                  'text':'2',
                  'attributes':{}}],
               'attributes':{}}],
            'attributes':{}}],
         'attributes':{'display':'block'}
        }
       );


treeTest.runTest(
  'Cube',
        {'type':'math',
         'children':[
           {'type':'mrow',
            'inferred':true,
            'children':[
              {'type':'msup',
               'children':[
                 {'type':'mi',
                  'text':'x',
                  'attributes':{}},
                 {'type':'mn',
                  'text':'3',
                  'attributes':{}}],
               'attributes':{}}],
            'attributes':{}}],
         'attributes':{'display':'block'}
        }
       );


treeTest.runTest(
  'Index',
        {'type':'math',
         'children':[
           {'type':'mrow',
            'inferred':true,
            'children':[
              {'type':'msub',
               'children':[
                 {'type':'mi',
                  'text':'x',
                  'attributes':{}},
                 {'type':'mn',
                  'text':'3',
                  'attributes':{}}],
               'attributes':{}}],
            'attributes':{}}],
         'attributes':{'display':'block'}
        }
       );


treeTest.runTest(
  'SubSup',
        {'type':'math',
         'children':[
           {'type':'mrow',
            'inferred':true,
            'children':[
              {'type':'msubsup',
               'children':[
                 {'type':'mi',
                  'text':'x',
                  'attributes':{}},
                 {'type':'mn',
                  'text':'3',
                  'attributes':{}},
                 {'type':'mi',
                  'text':'a',
                  'attributes':{}}],
               'attributes':{}}],
            'attributes':{}}],
         'attributes':{'display':'block'}
        }
       );


treeTest.runTest(
  'Prime',
  {'type':'math',
   'children':[
     {'type':'mrow',
      'inferred':true,
      'children':[
        {'type':'msub',
         'children':[
           {'type':'mi',
            'text':'x',
            'attributes':{}},
           {'type':'mo',
            'text':'′',
            'attributes':{}}],
         'attributes':{}}],
      'attributes':{}}],
   'attributes':{'display':'block'}}
);

treeTest.runTest(
  'Double Prime',
  {'type':'math',
   'children':[
     {'type':'mrow',
      'inferred':true,
      'children':[
        {'type':'msub',
         'children':[
           {'type':'mi',
            'text':'x',
            'attributes':{}},
           {'type':'mo',
            'text':'″',
            'attributes':{}}],
         'attributes':{}}],
      'attributes':{}}],
   'attributes':{'display':'block'}}
);


treeTest.runTest(
  'PrePrime',
  {'type':'math',
   'children':[
     {'type':'mrow',
      'inferred':true,
      'children':[
        {'type':'msub',
         'children':[
           {'type':'mi',
            'text':'x',
            'attributes':{}},
           {'type':'mo',
            'text':'″',
            'attributes':{}}],
         'attributes':{}}],
      'attributes':{}}],
   'attributes':{'display':'block'}}
);


treeTest.runTest(
  'Square Root Expression',
  {'type':'math',
   'children':[
     {'type':'mrow',
      'inferred':true,
      'children':[
	{'type':'msqrt',
         'children':[
	   {'type':'mrow',
            'inferred':true,
            'children':[
	      {'type':'mn',
               'text':'3',
               'attributes':{}},
	      {'type':'mi',
               'text':'x',
               'attributes':{}},
	      {'type':'mo',
               'text':'−',
               'attributes':{}},
	      {'type':'mn',
               'text':'1',
               'attributes':{}}],
            'attributes':{}}],
         'attributes':{}},
	{'type':'mo',
         'text':'+',
         'attributes':{}},
	{'type':'mo',
         'text':'(',
         'attributes':{'stretchy':false}},
	{'type':'mn',
         'text':'1',
         'attributes':{}},
	{'type':'mo',
         'text':'+',
         'attributes':{}},
	{'type':'mi',
         'text':'x',
         'attributes':{}},
	{'type':'msup',
         'children':[
	   {'type':'mo',
            'text':')',
            'attributes':{'stretchy':false}},
	   {'type':'mn',
            'text':'2',
            'attributes':{}}],
         'attributes':{}}],
      'attributes':{}}],
   'attributes':{'display':'block'}});


treeTest.runTest(
  'General Root Expression',
  {'type':'math',
   'children':[
     {'type':'mrow',
      'inferred':true,
      'children':[
	{'type':'mroot',
         'children':[
	   {"type":"mrow",
            "inferred":true,
            "children":[
              {'type':'mn',
               'text':'3',
               'attributes':{}},
	      {'type':'mi',
               'text':'x',
               'attributes':{}},
	      {'type':'mo',
               'text':'−',
               'attributes':{}},
	      {'type':'mn',
               'text':'1',
               'attributes':{}}],
            'attributes':{}},
           {'type':'mn',
            'text':'4',
            'attributes':{}}],
         'attributes':{}},
	{'type':'mo',
         'text':'+',
         'attributes':{}},
	{'type':'mo',
         'text':'(',
         'attributes':{'stretchy':false}},
	{'type':'mn',
         'text':'1',
         'attributes':{}},
	{'type':'mo',
         'text':'+',
         'attributes':{}},
	{'type':'mi',
         'text':'x',
         'attributes':{}},
	{'type':'msup',
         'children':[
	   {'type':'mo',
            'text':')',
            'attributes':{'stretchy':false}},
	   {'type':'mn',
            'text':'2',
            'attributes':{}}],
         'attributes':{}}],
      'attributes':{}}],
   'attributes':{'display':'block'}});


treeTest.runTest('Quadratic Formula',
        {'type':'math',
         'children':[
           {'type':'mrow',
            'inferred':true,
            'children':[
              {'type':'mi',
               'text':'x',
               'attributes':{}},
              {'type':'mo',
               'text':'=',
               'attributes':{}},
              {'type':'mfrac',
               'children':[
                 {'type':'mrow',
                  'inferred':true,
                  'children':[
                    {'type':'mo',
                     'text':'−',
                     'attributes':{}},
                    {'type':'mi',
                     'text':'b',
                     'attributes':{}},
                    {'type':'mo',
                     'text':'±',
                     'attributes':{}},
                    {'type':'msqrt',
                     'children':[
                       {'type':'mrow',
                        'inferred':true,
                        'children':[
                          {'type':'msup',
                           'children':[
                             {'type':'mi',
                              'text':'b',
                              'attributes':{}},
                             {'type':'mn',
                              'text':'2',
                              'attributes':{}}],
                           'attributes':{}},
                          {'type':'mo',
                           'text':'−',
                           'attributes':{}},
                          {'type':'mn',
                           'text':'4',
                           'attributes':{}},
                          {'type':'mi',
                           'text':'a',
                           'attributes':{}},
                          {'type':'mi',
                           'text':'c',
                           'attributes':{}}],
                        'attributes':{}}],
                     'attributes':{}}],
                  'attributes':{}},
                 {'type':'mrow',
                  'inferred':true,
                  'children':[
                    {'type':'mn',
                     'text':'2',
                     'attributes':{}},
                    {'type':'mi',
                     'text':'a',
                     'attributes':{}}],
                  'attributes':{}}],
               'attributes':{}}],
            'attributes':{}}],
         'attributes':{'display':'block'}}
       );


treeTest.runTest('Cauchy-Schwarz Inequality',
        {'type':'math',
         'children':[
           {'type':'mrow',
            'inferred':true,
            'children':[
              {'type':'msup',
               'children':[
                 {'type':'mrow',
                  'children':[
                    {'type':'mo',
                     'text':'(',
                     'attributes':{}},
                    {'type':'munderover',
                     'children':[
                       {'type':'mo',
                        'text':'∑',
                        'attributes':{}},
                       {'type':'mrow',
                        'children':[
                          {'type':'mrow',
                           'inferred':true,
                           'children':[
                             {'type':'mi',
                              'text':'k',
                              'attributes':{}},
                             {'type':'mo',
                              'text':'=',
                              'attributes':{}},
                             {'type':'mn',
                              'text':'1',
                              'attributes':{}}],
                           'attributes':{}}],
                        'attributes':{},
                        'TeXAtom':'ORD'},
                       {'type':'mi',
                        'text':'n',
                        'attributes':{}}],
                     'attributes':{}},
                    {'type':'msub',
                     'children':[
                       {'type':'mi',
                        'text':'a',
                        'attributes':{}},
                       {'type':'mi',
                        'text':'k',
                        'attributes':{}}],
                     'attributes':{}},
                    {'type':'msub',
                     'children':[
                       {'type':'mi',
                        'text':'b',
                        'attributes':{}},
                       {'type':'mi',
                        'text':'k',
                        'attributes':{}}],
                     'attributes':{}},
                    {'type':'mo',
                     'text':')',
                     'attributes':{}}],
                  'attributes':{}},
                 {'type':'mrow',
                  'children':[
                    {'type':'mrow',
                     'inferred':true,
                     'children':[
                       {'type':'mspace',
                        'text':'',
                        'attributes':{'width':'negativethinmathspace'}},
                       {'type':'mspace',
                        'text':'',
                        'attributes':{'width':'negativethinmathspace'}},
                       {'type':'mn',
                        'text':'2',
                        'attributes':{}}],
                     'attributes':{}}],
                  'attributes':{},
                  'TeXAtom':'ORD'}],
               'attributes':{}},
              {'type':'mo',
               'text':'≤',
               'attributes':{}},
              {'type':'mrow',
               'children':[
                 {'type':'mo',
                  'text':'(',
                  'attributes':{}},
                 {'type':'munderover',
                  'children':[
                    {'type':'mo',
                     'text':'∑',
                     'attributes':{}},
                    {'type':'mrow',
                     'children':[
                       {'type':'mrow',
                        'inferred':true,
                        'children':[
                          {'type':'mi',
                           'text':'k',
                           'attributes':{}},
                          {'type':'mo',
                           'text':'=',
                           'attributes':{}},
                          {'type':'mn',
                           'text':'1',
                           'attributes':{}}],
                        'attributes':{}}],
                     'attributes':{},
                     'TeXAtom':'ORD'},
                    {'type':'mi',
                     'text':'n',
                     'attributes':{}}],
                  'attributes':{}},
                 {'type':'msubsup',
                  'children':[
                    {'type':'mi',
                     'text':'a',
                     'attributes':{}},
                    {'type':'mi',
                     'text':'k',
                     'attributes':{}},
                    {'type':'mn',
                     'text':'2',
                     'attributes':{}}],
                  'attributes':{}},
                 {'type':'mo',
                  'text':')',
                  'attributes':{}}],
               'attributes':{}},
              {'type':'mrow',
               'children':[
                 {'type':'mo',
                  'text':'(',
                  'attributes':{}},
                 {'type':'munderover',
                  'children':[
                    {'type':'mo',
                     'text':'∑',
                     'attributes':{}},
                    {'type':'mrow',
                     'children':[
                       {'type':'mrow',
                        'inferred':true,
                        'children':[
                          {'type':'mi',
                           'text':'k',
                           'attributes':{}},
                          {'type':'mo',
                           'text':'=',
                           'attributes':{}},
                          {'type':'mn',
                           'text':'1',
                           'attributes':{}}],
                        'attributes':{}}],
                     'attributes':{},
                     'TeXAtom':'ORD'},
                    {'type':'mi',
                     'text':'n',
                     'attributes':{}}],
                  'attributes':{}},
                 {'type':'msubsup',
                  'children':[
                    {'type':'mi',
                     'text':'b',
                     'attributes':{}},
                    {'type':'mi',
                     'text':'k',
                     'attributes':{}},
                    {'type':'mn',
                     'text':'2',
                     'attributes':{}}],
                  'attributes':{}},
                 {'type':'mo',
                  'text':')',
                  'attributes':{}}],
               'attributes':{}}],
            'attributes':{}}],
         'attributes':{'display':'block'}}
       );



treeTest.runTest('An Identity of Ramanujan',
        {'type':'math',
         'children':[
           {'type':'mrow',
            'inferred':true,
            'children':[
              {'type':'mfrac',
               'children':[
                 {'type':'mn',
                  'text':'1',
                  'attributes':{}},
                 {'type':'mrow',
                  'inferred':true,
                  'children':[
                    {'type':'mrow',
                     'children':[
                       {'type':'mrow',
                        'inferred':true,
                        'children':[
                          {'type':'mo',
                           'text':'(',
                           'attributes':{'maxsize':'1.623em',
                                         'minsize':'1.623em'}}],
                        'attributes':{}}],
                     'attributes':{},
                     'TeXAtom':'OPEN'},
                    {'type':'msqrt',
                     'children':[
                       {'type':'mrow',
                        'inferred':true,
                        'children':[
                          {'type':'mi',
                           'text':'ϕ',
                           'attributes':{}},
                          {'type':'msqrt',
                           'children':[
                             {'type':'mrow',
                              'inferred':true,
                              'children':[
                                {'type':'mn',
                                 'text':'5',
                                 'attributes':{}}],
                              'attributes':{}}],
                           'attributes':{}}],
                        'attributes':{}}],
                     'attributes':{}},
                    {'type':'mo',
                     'text':'−',
                     'attributes':{}},
                    {'type':'mi',
                     'text':'ϕ',
                     'attributes':{}},
                    {'type':'mrow',
                     'children':[
                       {'type':'mrow',
                        'inferred':true,
                        'children':[
                          {'type':'mo',
                           'text':')',
                           'attributes':{'maxsize':'1.623em',
                                         'minsize':'1.623em'}}],
                        'attributes':{}}],
                     'attributes':{},
                     'TeXAtom':'CLOSE'},
                    {'type':'msup',
                     'children':[
                       {'type':'mi',
                        'text':'e',
                        'attributes':{}},
                       {'type':'mrow',
                        'children':[
                          {'type':'mrow',
                           'inferred':true,
                           'children':[
                             {'type':'mfrac',
                              'children':[
                                {'type':'mn',
                                 'text':'2',
                                 'attributes':{}},
                                {'type':'mn',
                                 'text':'5',
                                 'attributes':{}}],
                              'attributes':{}},
                             {'type':'mi',
                              'text':'π',
                              'attributes':{}}],
                           'attributes':{}}],
                        'attributes':{},
                        'TeXAtom':'ORD'}],
                     'attributes':{}}],
                  'attributes':{}}],
               'attributes':{}},
              {'type':'mo',
               'text':'=',
               'attributes':{}},
              {'type':'mn',
               'text':'1',
               'attributes':{}},
              {'type':'mo',
               'text':'+',
               'attributes':{}},
              {'type':'mfrac',
               'children':[
                 {'type':'msup',
                  'children':[
                    {'type':'mi',
                     'text':'e',
                     'attributes':{}},
                    {'type':'mrow',
                     'children':[
                       {'type':'mrow',
                        'inferred':true,
                        'children':[
                          {'type':'mo',
                           'text':'−',
                           'attributes':{}},
                          {'type':'mn',
                           'text':'2',
                           'attributes':{}},
                          {'type':'mi',
                           'text':'π',
                           'attributes':{}}],
                        'attributes':{}}],
                     'attributes':{},
                     'TeXAtom':'ORD'}],
                  'attributes':{}},
                 {'type':'mrow',
                  'inferred':true,
                  'children':[
                    {'type':'mn',
                     'text':'1',
                     'attributes':{}},
                    {'type':'mo',
                     'text':'+',
                     'attributes':{}},
                    {'type':'mfrac',
                     'children':[
                       {'type':'msup',
                        'children':[
                          {'type':'mi',
                           'text':'e',
                           'attributes':{}},
                          {'type':'mrow',
                           'children':[
                             {'type':'mrow',
                              'inferred':true,
                              'children':[
                                {'type':'mo',
                                 'text':'−',
                                 'attributes':{}},
                                {'type':'mn',
                                 'text':'4',
                                 'attributes':{}},
                                {'type':'mi',
                                 'text':'π',
                                 'attributes':{}}],
                              'attributes':{}}],
                           'attributes':{},
                           'TeXAtom':'ORD'}],
                        'attributes':{}},
                       {'type':'mrow',
                        'inferred':true,
                        'children':[
                          {'type':'mn',
                           'text':'1',
                           'attributes':{}},
                          {'type':'mo',
                           'text':'+',
                           'attributes':{}},
                          {'type':'mfrac',
                           'children':[
                             {'type':'msup',
                              'children':[
                                {'type':'mi',
                                 'text':'e',
                                 'attributes':{}},
                                {'type':'mrow',
                                 'children':[
                                   {'type':'mrow',
                                    'inferred':true,
                                    'children':[
                                      {'type':'mo',
                                       'text':'−',
                                       'attributes':{}},
                                      {'type':'mn',
                                       'text':'6',
                                       'attributes':{}},
                                      {'type':'mi',
                                       'text':'π',
                                       'attributes':{}}],
                                    'attributes':{}}],
                                 'attributes':{},
                                 'TeXAtom':'ORD'}],
                              'attributes':{}},
                             {'type':'mrow',
                              'inferred':true,
                              'children':[
                                {'type':'mn',
                                 'text':'1',
                                 'attributes':{}},
                                {'type':'mo',
                                 'text':'+',
                                 'attributes':{}},
                                {'type':'mfrac',
                                 'children':[
                                   {'type':'msup',
                                    'children':[
                                      {'type':'mi',
                                       'text':'e',
                                       'attributes':{}},
                                      {'type':'mrow',
                                       'children':[
                                         {'type':'mrow',
                                          'inferred':true,
                                          'children':[
                                            {'type':'mo',
                                             'text':'−',
                                             'attributes':{}},
                                            {'type':'mn',
                                             'text':'8',
                                             'attributes':{}},
                                            {'type':'mi',
                                             'text':'π',
                                             'attributes':{}}],
                                          'attributes':{}}],
                                       'attributes':{},
                                       'TeXAtom':'ORD'}],
                                    'attributes':{}},
                                   {'type':'mrow',
                                    'inferred':true,
                                    'children':[
                                      {'type':'mn',
                                       'text':'1',
                                       'attributes':{}},
                                      {'type':'mo',
                                       'text':'+',
                                       'attributes':{}},
                                      {'type':'mo',
                                       'text':'…',
                                       'attributes':{}}],
                                    'attributes':{}}],
                                 'attributes':{}}],
                              'attributes':{}}],
                           'attributes':{}}],
                        'attributes':{}}],
                     'attributes':{}}],
                  'attributes':{}}],
               'attributes':{}}],
            'attributes':{}}],
         'attributes':{'display':'block'}}
       );


treeTest.runTest('A Rogers-Ramanujan Identity',
        {'type':'math',
         'children':[
           {'type':'mrow',
            'inferred':true,
            'children':[
              {'type':'mn',
               'text':'1',
               'attributes':{}},
              {'type':'mo',
               'text':'+',
               'attributes':{}},
              {'type':'mfrac',
               'children':[
                 {'type':'msup',
                  'children':[
                    {'type':'mi',
                     'text':'q',
                     'attributes':{}},
                    {'type':'mn',
                     'text':'2',
                     'attributes':{}}],
                  'attributes':{}},
                 {'type':'mrow',
                  'inferred':true,
                  'children':[
                    {'type':'mo',
                     'text':'(',
                     'attributes':{'stretchy':false}},
                    {'type':'mn',
                     'text':'1',
                     'attributes':{}},
                    {'type':'mo',
                     'text':'−',
                     'attributes':{}},
                    {'type':'mi',
                     'text':'q',
                     'attributes':{}},
                    {'type':'mo',
                     'text':')',
                     'attributes':{'stretchy':false}}],
                  'attributes':{}}],
               'attributes':{}},
              {'type':'mo',
               'text':'+',
               'attributes':{}},
              {'type':'mfrac',
               'children':[
                 {'type':'msup',
                  'children':[
                    {'type':'mi',
                     'text':'q',
                     'attributes':{}},
                    {'type':'mn',
                     'text':'6',
                     'attributes':{}}],
                  'attributes':{}},
                 {'type':'mrow',
                  'inferred':true,
                  'children':[
                    {'type':'mo',
                     'text':'(',
                     'attributes':{'stretchy':false}},
                    {'type':'mn',
                     'text':'1',
                     'attributes':{}},
                    {'type':'mo',
                     'text':'−',
                     'attributes':{}},
                    {'type':'mi',
                     'text':'q',
                     'attributes':{}},
                    {'type':'mo',
                     'text':')',
                     'attributes':{'stretchy':false}},
                    {'type':'mo',
                     'text':'(',
                     'attributes':{'stretchy':false}},
                    {'type':'mn',
                     'text':'1',
                     'attributes':{}},
                    {'type':'mo',
                     'text':'−',
                     'attributes':{}},
                    {'type':'msup',
                     'children':[
                       {'type':'mi',
                        'text':'q',
                        'attributes':{}},
                       {'type':'mn',
                        'text':'2',
                        'attributes':{}}],
                     'attributes':{}},
                    {'type':'mo',
                     'text':')',
                     'attributes':{'stretchy':false}}],
                  'attributes':{}}],
               'attributes':{}},
              {'type':'mo',
               'text':'+',
               'attributes':{}},
              {'type':'mo',
               'text':'⋯',
               'attributes':{}},
              {'type':'mo',
               'text':'=',
               'attributes':{}},
              {'type':'munderover',
               'children':[
                 {'type':'mo',
                  'text':'∏',
                  'attributes':{}},
                 {'type':'mrow',
                  'children':[
                    {'type':'mrow',
                     'inferred':true,
                     'children':[
                       {'type':'mi',
                        'text':'j',
                        'attributes':{}},
                       {'type':'mo',
                        'text':'=',
                        'attributes':{}},
                       {'type':'mn',
                        'text':'0',
                        'attributes':{}}],
                     'attributes':{}}],
                  'attributes':{},
                  'TeXAtom':'ORD'},
                 {'type':'mrow',
                  'children':[
                    {'type':'mrow',
                     'inferred':true,
                     'children':[
                       {'type':'mi',
                        'text':'∞',
                        'attributes':{'mathvariant':'normal'}}],
                     'attributes':{}}],
                  'attributes':{},
                  'TeXAtom':'ORD'}],
               'attributes':{}},
              {'type':'mfrac',
               'children':[
                 {'type':'mn',
                  'text':'1',
                  'attributes':{}},
                 {'type':'mrow',
                  'inferred':true,
                  'children':[
                    {'type':'mo',
                     'text':'(',
                     'attributes':{'stretchy':false}},
                    {'type':'mn',
                     'text':'1',
                     'attributes':{}},
                    {'type':'mo',
                     'text':'−',
                     'attributes':{}},
                    {'type':'msup',
                     'children':[
                       {'type':'mi',
                        'text':'q',
                        'attributes':{}},
                       {'type':'mrow',
                        'children':[
                          {'type':'mrow',
                           'inferred':true,
                           'children':[
                             {'type':'mn',
                              'text':'5',
                              'attributes':{}},
                             {'type':'mi',
                              'text':'j',
                              'attributes':{}},
                             {'type':'mo',
                              'text':'+',
                              'attributes':{}},
                             {'type':'mn',
                              'text':'2',
                              'attributes':{}}],
                           'attributes':{}}],
                        'attributes':{},
                        'TeXAtom':'ORD'}],
                     'attributes':{}},
                    {'type':'mo',
                     'text':')',
                     'attributes':{'stretchy':false}},
                    {'type':'mo',
                     'text':'(',
                     'attributes':{'stretchy':false}},
                    {'type':'mn',
                     'text':'1',
                     'attributes':{}},
                    {'type':'mo',
                     'text':'−',
                     'attributes':{}},
                    {'type':'msup',
                     'children':[
                       {'type':'mi',
                        'text':'q',
                        'attributes':{}},
                       {'type':'mrow',
                        'children':[
                          {'type':'mrow',
                           'inferred':true,
                           'children':[
                             {'type':'mn',
                              'text':'5',
                              'attributes':{}},
                             {'type':'mi',
                              'text':'j',
                              'attributes':{}},
                             {'type':'mo',
                              'text':'+',
                              'attributes':{}},
                             {'type':'mn',
                              'text':'3',
                              'attributes':{}}],
                           'attributes':{}}],
                        'attributes':{},
                        'TeXAtom':'ORD'}],
                     'attributes':{}},
                    {'type':'mo',
                     'text':')',
                     'attributes':{'stretchy':false}}],
                  'attributes':{}}],
               'attributes':{}},
              {'type':'mo',
               'text':',',
               'attributes':{}},
              {'type':'mspace',
               'text':'',
               'attributes':{'width':'1em'}},
              {'type':'mspace',
               'text':'',
               'attributes':{'width':'1em'}},
              {'type':'mrow',
               'children':[
                 {'type':'mtext',
                  'text':'for ',
                  'attributes':{}},
                 {'type':'mrow',
                  'children':[
                    {'type':'mrow',
                     'inferred':true,
                     'children':[
                       {'type':'mrow',
                        'children':[
                          {'type':'mrow',
                           'inferred':true,
                           'children':[
                             {'type':'mo',
                              'text':'|',
                              'attributes':{'stretchy':false}}],
                           'attributes':{}}],
                        'attributes':{},
                        'TeXAtom':'ORD'},
                       {'type':'mi',
                        'text':'q',
                        'attributes':{}},
                       {'type':'mrow',
                        'children':[
                          {'type':'mrow',
                           'inferred':true,
                           'children':[
                             {'type':'mo',
                              'text':'|',
                              'attributes':{'stretchy':false}}],
                           'attributes':{}}],
                        'attributes':{},
                        'TeXAtom':'ORD'},
                       {'type':'mo',
                        'text':'<',
                        'attributes':{}},
                       {'type':'mn',
                        'text':'1',
                        'attributes':{}}],
                     'attributes':{}}],
                  'attributes':{},
                  'TeXAtom':'ORD'}],
               'attributes':{}},
              {'type':'mo',
               'text':'.',
               'attributes':{}}],
            'attributes':{}}],
         'attributes':{'display':'block'}}
       );

treeTest.runTest('A Summation Formula',
        {'type':'math',
         'children':[
           {'type':'mrow',
            'inferred':true,
            'children':[
              {'type':'munderover',
               'children':[
                 {'type':'mo',
                  'text':'∑',
                  'attributes':{}},
                 {'type':'mrow',
                  'children':[
                    {'type':'mrow',
                     'inferred':true,
                     'children':[
                       {'type':'mi',
                        'text':'n',
                        'attributes':{}},
                       {'type':'mo',
                        'text':'=',
                        'attributes':{}},
                       {'type':'mn',
                        'text':'1',
                        'attributes':{}}],
                     'attributes':{}}],
                  'attributes':{},
                  'TeXAtom':'ORD'},
                 {'type':'mi',
                  'text':'∞',
                  'attributes':{'mathvariant':'normal'}}],
               'attributes':{}},
              {'type':'mrow',
               'children':[
                 {'type':'mrow',
                  'inferred':true,
                  'children':[
                    {'type':'mfrac',
                     'children':[
                       {'type':'mn',
                        'text':'1',
                        'attributes':{}},
                       {'type':'msup',
                        'children':[
                          {'type':'mi',
                           'text':'n',
                           'attributes':{}},
                          {'type':'mn',
                           'text':'2',
                           'attributes':{}}],
                        'attributes':{}}],
                     'attributes':{}}],
                  'attributes':{}}],
               'attributes':{},
               'TeXAtom':'ORD'},
              {'type':'mo',
               'text':'=',
               'attributes':{}},
              {'type':'mrow',
               'children':[
                 {'type':'mrow',
                  'inferred':true,
                  'children':[
                    {'type':'mfrac',
                     'children':[
                       {'type':'msup',
                        'children':[
                          {'type':'mi',
                           'text':'π',
                           'attributes':{}},
                          {'type':'mn',
                           'text':'2',
                           'attributes':{}}],
                        'attributes':{}},
                       {'type':'mn',
                        'text':'6',
                        'attributes':{}}],
                     'attributes':{}}],
                  'attributes':{}}],
               'attributes':{},
               'TeXAtom':'ORD'}],
            'attributes':{}}],
         'attributes':{'display':'block'}}
       );


treeTest.runTest('Cauchy\'s Integral Formula',
        {'type':'math',
         'children':[
           {'type':'mrow',
            'inferred':true,
            'children':[
              {'type':'mi',
               'text':'f',
               'attributes':{}},
              {'type':'mo',
               'text':'(',
               'attributes':{'stretchy':false}},
              {'type':'mi',
               'text':'a',
               'attributes':{}},
              {'type':'mo',
               'text':')',
               'attributes':{'stretchy':false}},
              {'type':'mo',
               'text':'=',
               'attributes':{}},
              {'type':'msub',
               'children':[
                 {'type':'mo',
                  'text':'∮',
                  'attributes':{}},
                 {'type':'mi',
                  'text':'γ',
                  'attributes':{}}],
               'attributes':{}},
              {'type':'mfrac',
               'children':[
                 {'type':'mrow',
                  'inferred':true,
                  'children':[
                    {'type':'mi',
                     'text':'f',
                     'attributes':{}},
                    {'type':'mo',
                     'text':'(',
                     'attributes':{'stretchy':false}},
                    {'type':'mi',
                     'text':'z',
                     'attributes':{}},
                    {'type':'mo',
                     'text':')',
                     'attributes':{'stretchy':false}}],
                  'attributes':{}},
                 {'type':'mrow',
                  'inferred':true,
                  'children':[
                    {'type':'mi',
                     'text':'z',
                     'attributes':{}},
                    {'type':'mo',
                     'text':'−',
                     'attributes':{}},
                    {'type':'mi',
                     'text':'a',
                     'attributes':{}}],
                  'attributes':{}}],
               'attributes':{}},
              {'type':'mi',
               'text':'d',
               'attributes':{}},
              {'type':'mi',
               'text':'z',
               'attributes':{}}],
            'attributes':{}}],
         'attributes':{'display':'block'}}
       );

treeTest.runTest('Standard Deviation',
        {'type':'math',
         'children':[
           {'type':'mrow',
            'inferred':true,
            'children':[
              {'type':'mi',
               'text':'σ',
               'attributes':{}},
              {'type':'mo',
               'text':'=',
               'attributes':{}},
              {'type':'msqrt',
               'children':[
                 {'type':'mrow',
                  'inferred':true,
                  'children':[
                    {'type':'mfrac',
                     'children':[
                       {'type':'mn',
                        'text':'1',
                        'attributes':{}},
                       {'type':'mi',
                        'text':'N',
                        'attributes':{}}],
                     'attributes':{}},
                    {'type':'munderover',
                     'children':[
                       {'type':'mo',
                        'text':'∑',
                        'attributes':{}},
                       {'type':'mrow',
                        'children':[
                          {'type':'mrow',
                           'inferred':true,
                           'children':[
                             {'type':'mi',
                              'text':'i',
                              'attributes':{}},
                             {'type':'mo',
                              'text':'=',
                              'attributes':{}},
                             {'type':'mn',
                              'text':'1',
                              'attributes':{}}],
                           'attributes':{}}],
                        'attributes':{},
                        'TeXAtom':'ORD'},
                       {'type':'mi',
                        'text':'N',
                        'attributes':{}}],
                     'attributes':{}},
                    {'type':'msup',
                     'children':[
                       {'type':'mrow',
                        'children':[
                          {'type':'mrow',
                           'inferred':true,
                           'children':[
                             {'type':'mo',
                              'text':'(',
                              'attributes':{'stretchy':false}},
                             {'type':'msub',
                              'children':[
                                {'type':'mi',
                                 'text':'x',
                                 'attributes':{}},
                                {'type':'mi',
                                 'text':'i',
                                 'attributes':{}}],
                              'attributes':{}},
                             {'type':'mo',
                              'text':'−',
                              'attributes':{}},
                             {'type':'mi',
                              'text':'μ',
                              'attributes':{}},
                             {'type':'mo',
                              'text':')',
                              'attributes':{'stretchy':false}}],
                           'attributes':{}}],
                        'attributes':{},
                        'TeXAtom':'ORD'},
                       {'type':'mn',
                        'text':'2',
                        'attributes':{}}],
                     'attributes':{}}],
                  'attributes':{}}],
               'attributes':{}}],
            'attributes':{}}],
         'attributes':{'display':'block'}}
       );


treeTest.amsTest(
  'The Lorenz Equations',
  {'type':'math',
   'children':[
     {'type':'mrow',
      'inferred':true,
      'children':[
	{'type':'mtable',
         'children':[
	   {'type':'mtr',
            'children':[
	      {'type':'mtd',
               'children':[
	         {'type':'mrow',
                  'inferred':true,
                  'children':[
	            {'type':'mrow',
                     'children':[
	               {'type':'mrow',
                        'inferred':true,
                        'children':[
	                  {'type':'mover',
                           'children':[
	                     {'type':'mi',
                              'text':'x',
                              'attributes':{}},
	                     {'type':'mo',
                              'text':'˙',
                              'attributes':{}}],
                           'attributes':{}}],
                        'attributes':{}}],
                     'attributes':{},
                     'TeXAtom':'ORD'}],
                  'attributes':{}}],
               'attributes':{}},
	      {'type':'mtd',
               'children':[
	         {'type':'mrow',
                  'inferred':true,
                  'children':[
	            {'type':'mi',
                     'text':'',
                     'attributes':{}},
	            {'type':'mo',
                     'text':'=',
                     'attributes':{}},
	            {'type':'mi',
                     'text':'σ',
                     'attributes':{}},
	            {'type':'mo',
                     'text':'(',
                     'attributes':{'stretchy':false}},
	            {'type':'mi',
                     'text':'y',
                     'attributes':{}},
	            {'type':'mo',
                     'text':'−',
                     'attributes':{}},
	            {'type':'mi',
                     'text':'x',
                     'attributes':{}},
	            {'type':'mo',
                     'text':')',
                     'attributes':{'stretchy':false}}],
                  'attributes':{}}],
               'attributes':{}}],
            'attributes':{}},
	   {'type':'mtr',
            'children':[
	      {'type':'mtd',
               'children':[
	         {'type':'mrow',
                  'inferred':true,
                  'children':[
	            {'type':'mrow',
                     'children':[
	               {'type':'mrow',
                        'inferred':true,
                        'children':[
	                  {'type':'mover',
                           'children':[
	                     {'type':'mi',
                              'text':'y',
                              'attributes':{}},
	                     {'type':'mo',
                              'text':'˙',
                              'attributes':{}}],
                           'attributes':{}}],
                        'attributes':{}}],
                     'attributes':{},
                     'TeXAtom':'ORD'}],
                  'attributes':{}}],
               'attributes':{}},
	      {'type':'mtd',
               'children':[
	         {'type':'mrow',
                  'inferred':true,
                  'children':[
	            {'type':'mi',
                     'text':'',
                     'attributes':{}},
	            {'type':'mo',
                     'text':'=',
                     'attributes':{}},
	            {'type':'mi',
                     'text':'ρ',
                     'attributes':{}},
	            {'type':'mi',
                     'text':'x',
                     'attributes':{}},
	            {'type':'mo',
                     'text':'−',
                     'attributes':{}},
	            {'type':'mi',
                     'text':'y',
                     'attributes':{}},
	            {'type':'mo',
                     'text':'−',
                     'attributes':{}},
	            {'type':'mi',
                     'text':'x',
                     'attributes':{}},
	            {'type':'mi',
                     'text':'z',
                     'attributes':{}}],
                  'attributes':{}}],
               'attributes':{}}],
            'attributes':{}},
	   {'type':'mtr',
            'children':[
	      {'type':'mtd',
               'children':[
	         {'type':'mrow',
                  'inferred':true,
                  'children':[
	            {'type':'mrow',
                     'children':[
	               {'type':'mrow',
                        'inferred':true,
                        'children':[
	                  {'type':'mover',
                           'children':[
	                     {'type':'mi',
                              'text':'z',
                              'attributes':{}},
	                     {'type':'mo',
                              'text':'˙',
                              'attributes':{}}],
                           'attributes':{}}],
                        'attributes':{}}],
                     'attributes':{},
                     'TeXAtom':'ORD'}],
                  'attributes':{}}],
               'attributes':{}},
	      {'type':'mtd',
               'children':[
	         {'type':'mrow',
                  'inferred':true,
                  'children':[
	            {'type':'mi',
                     'text':'',
                     'attributes':{}},
	            {'type':'mo',
                     'text':'=',
                     'attributes':{}},
	            {'type':'mo',
                     'text':'−',
                     'attributes':{}},
	            {'type':'mi',
                     'text':'β',
                     'attributes':{}},
	            {'type':'mi',
                     'text':'z',
                     'attributes':{}},
	            {'type':'mo',
                     'text':'+',
                     'attributes':{}},
	            {'type':'mi',
                     'text':'x',
                     'attributes':{}},
	            {'type':'mi',
                     'text':'y',
                     'attributes':{}}],
                  'attributes':{}}],
               'attributes':{}}],
            'attributes':{}}],
         'attributes':{'columnalign':'right left right left right left right left right left right left',
                       'rowspacing':'3pt',
                       'columnspacing':'0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em',
                       'displaystyle':true}}],
      'attributes':{}}],
   'attributes':{'display':'block'}});


treeTest.runTest(
  'A Cross Product Formula',
  {'type':'math',
   'children':[
     {'type':'mrow',
      'inferred':true,
      'children':[
	{'type':'msub',
         'children':[
	   {'type':'mrow',
            'children':[
	      {'type':'mrow',
               'inferred':true,
               'children':[
	         {'type':'mi',
                  'text':'V',
                  'attributes':{'mathvariant':'bold'}}],
               'attributes':{}}],
            'attributes':{},
            'TeXAtom':'ORD'},
	   {'type':'mn',
            'text':'1',
            'attributes':{}}],
         'attributes':{}},
	{'type':'mo',
         'text':'×',
         'attributes':{}},
	{'type':'msub',
         'children':[
	   {'type':'mrow',
            'children':[
	      {'type':'mrow',
               'inferred':true,
               'children':[
	         {'type':'mi',
                  'text':'V',
                  'attributes':{'mathvariant':'bold'}}],
               'attributes':{}}],
            'attributes':{},
            'TeXAtom':'ORD'},
	   {'type':'mn',
            'text':'2',
            'attributes':{}}],
         'attributes':{}},
	{'type':'mo',
         'text':'=',
         'attributes':{}},
	{'type':'mrow',
         'children':[
	   {'type':'mo',
            'text':'|',
            'attributes':{}},
	   {'type':'mtable',
            'children':[
	      {'type':'mtr',
               'children':[
	         {'type':'mtd',
                  'children':[
	            {'type':'mrow',
                     'inferred':true,
                     'children':[
	               {'type':'mrow',
                        'children':[
	                  {'type':'mrow',
                           'inferred':true,
                           'children':[
	                     {'type':'mi',
                              'text':'i',
                              'attributes':{'mathvariant':'bold'}}],
                           'attributes':{}}],
                        'attributes':{},
                        'TeXAtom':'ORD'}],
                     'attributes':{}}],
                  'attributes':{}},
	         {'type':'mtd',
                  'children':[
	            {'type':'mrow',
                     'inferred':true,
                     'children':[
	               {'type':'mrow',
                        'children':[
	                  {'type':'mrow',
                           'inferred':true,
                           'children':[
	                     {'type':'mi',
                              'text':'j',
                              'attributes':{'mathvariant':'bold'}}],
                           'attributes':{}}],
                        'attributes':{},
                        'TeXAtom':'ORD'}],
                     'attributes':{}}],
                  'attributes':{}},
	         {'type':'mtd',
                  'children':[
	            {'type':'mrow',
                     'inferred':true,
                     'children':[
	               {'type':'mrow',
                        'children':[
	                  {'type':'mrow',
                           'inferred':true,
                           'children':[
	                     {'type':'mi',
                              'text':'k',
                              'attributes':{'mathvariant':'bold'}}],
                           'attributes':{}}],
                        'attributes':{},
                        'TeXAtom':'ORD'}],
                     'attributes':{}}],
                  'attributes':{}}],
               'attributes':{}},
	      {'type':'mtr',
               'children':[
	         {'type':'mtd',
                  'children':[
	            {'type':'mrow',
                     'inferred':true,
                     'children':[
	               {'type':'mfrac',
                        'children':[
	                  {'type':'mrow',
                           'inferred':true,
                           'children':[
	                     {'type':'mi',
                              'text':'∂',
                              'attributes':{'mathvariant':'normal'}},
	                     {'type':'mi',
                              'text':'X',
                              'attributes':{}}],
                           'attributes':{}},
	                  {'type':'mrow',
                           'inferred':true,
                           'children':[
	                     {'type':'mi',
                              'text':'∂',
                              'attributes':{'mathvariant':'normal'}},
	                     {'type':'mi',
                              'text':'u',
                              'attributes':{}}],
                           'attributes':{}}],
                        'attributes':{}}],
                     'attributes':{}}],
                  'attributes':{}},
	         {'type':'mtd',
                  'children':[
	            {'type':'mrow',
                     'inferred':true,
                     'children':[
	               {'type':'mfrac',
                        'children':[
	                  {'type':'mrow',
                           'inferred':true,
                           'children':[
	                     {'type':'mi',
                              'text':'∂',
                              'attributes':{'mathvariant':'normal'}},
	                     {'type':'mi',
                              'text':'Y',
                              'attributes':{}}],
                           'attributes':{}},
	                  {'type':'mrow',
                           'inferred':true,
                           'children':[
	                     {'type':'mi',
                              'text':'∂',
                              'attributes':{'mathvariant':'normal'}},
	                     {'type':'mi',
                              'text':'u',
                              'attributes':{}}],
                           'attributes':{}}],
                        'attributes':{}}],
                     'attributes':{}}],
                  'attributes':{}},
	         {'type':'mtd',
                  'children':[
	            {'type':'mrow',
                     'inferred':true,
                     'children':[
	               {'type':'mn',
                        'text':'0',
                        'attributes':{}}],
                     'attributes':{}}],
                  'attributes':{}}],
               'attributes':{}},
	      {'type':'mtr',
               'children':[
	         {'type':'mtd',
                  'children':[
	            {'type':'mrow',
                     'inferred':true,
                     'children':[
	               {'type':'mfrac',
                        'children':[
	                  {'type':'mrow',
                           'inferred':true,
                           'children':[
	                     {'type':'mi',
                              'text':'∂',
                              'attributes':{'mathvariant':'normal'}},
	                     {'type':'mi',
                              'text':'X',
                              'attributes':{}}],
                           'attributes':{}},
	                  {'type':'mrow',
                           'inferred':true,
                           'children':[
	                     {'type':'mi',
                              'text':'∂',
                              'attributes':{'mathvariant':'normal'}},
	                     {'type':'mi',
                              'text':'v',
                              'attributes':{}}],
                           'attributes':{}}],
                        'attributes':{}}],
                     'attributes':{}}],
                  'attributes':{}},
	         {'type':'mtd',
                  'children':[
	            {'type':'mrow',
                     'inferred':true,
                     'children':[
	               {'type':'mfrac',
                        'children':[
	                  {'type':'mrow',
                           'inferred':true,
                           'children':[
	                     {'type':'mi',
                              'text':'∂',
                              'attributes':{'mathvariant':'normal'}},
	                     {'type':'mi',
                              'text':'Y',
                              'attributes':{}}],
                           'attributes':{}},
	                  {'type':'mrow',
                           'inferred':true,
                           'children':[
	                     {'type':'mi',
                              'text':'∂',
                              'attributes':{'mathvariant':'normal'}},
	                     {'type':'mi',
                              'text':'v',
                              'attributes':{}}],
                           'attributes':{}}],
                        'attributes':{}}],
                     'attributes':{}}],
                  'attributes':{}},
	         {'type':'mtd',
                  'children':[
	            {'type':'mrow',
                     'inferred':true,
                     'children':[
	               {'type':'mn',
                        'text':'0',
                        'attributes':{}}],
                     'attributes':{}}],
                  'attributes':{}}],
               'attributes':{}}],
            'attributes':{'rowspacing':'4pt',
                          'columnspacing':'1em'}},
	   {'type':'mo',
            'text':'|',
            'attributes':{}}],
         'attributes':{}}],
      'attributes':{}}],
   'attributes':{'display':'block'}});


treeTest.amsTest(
  'Probability',
  {'type':'math',
   'children':[
     {'type':'mrow',
      'inferred':true,
      'children':[
	{'type':'mi',
         'text':'P',
         'attributes':{}},
	{'type':'mo',
         'text':'(',
         'attributes':{'stretchy':false}},
	{'type':'mi',
         'text':'E',
         'attributes':{}},
	{'type':'mo',
         'text':')',
         'attributes':{'stretchy':false}},
	{'type':'mo',
         'text':'=',
         'attributes':{}},
	{'type':'mrow',
         'children':[
	   {'type':'mrow',
            'inferred':true,
            'children':[
	      {'type':'mrow',
               'children':[
	         {'type':'TeXmathchoice',
                  'children':[
	            {'type':'mrow',
                     'children':[
	               {'type':'mrow',
                        'inferred':true,
                        'children':[
	                  {'type':'mo',
                           'text':'(',
                           'attributes':{'maxsize':'2.047em',
                                         'minsize':'2.047em'}}],
                        'attributes':{}}],
                     'attributes':{},
                     'TeXAtom':'OPEN'},
	            {'type':'mrow',
                     'children':[
	               {'type':'mrow',
                        'inferred':true,
                        'children':[
	                  {'type':'mo',
                           'text':'(',
                           'attributes':{'maxsize':'1.2em',
                                         'minsize':'1.2em'}}],
                        'attributes':{}}],
                     'attributes':{},
                     'TeXAtom':'OPEN'},
	            {'type':'mrow',
                     'children':[
	               {'type':'mrow',
                        'inferred':true,
                        'children':[
	                  {'type':'mo',
                           'text':'(',
                           'attributes':{'maxsize':'1.2em',
                                         'minsize':'1.2em'}}],
                        'attributes':{}}],
                     'attributes':{},
                     'TeXAtom':'OPEN'},
	            {'type':'mrow',
                     'children':[
	               {'type':'mrow',
                        'inferred':true,
                        'children':[
	                  {'type':'mo',
                           'text':'(',
                           'attributes':{'maxsize':'1.2em',
                                         'minsize':'1.2em'}}],
                        'attributes':{}}],
                     'attributes':{},
                     'TeXAtom':'OPEN'}],
                  'attributes':{}},
	         {'type':'mfrac',
                  'children':[
	            {'type':'mi',
                     'text':'n',
                     'attributes':{}},
	            {'type':'mi',
                     'text':'k',
                     'attributes':{}}],
                  'attributes':{'linethickness':0}},
	         {'type':'TeXmathchoice',
                  'children':[
	            {'type':'mrow',
                     'children':[
	               {'type':'mrow',
                        'inferred':true,
                        'children':[
	                  {'type':'mo',
                           'text':')',
                           'attributes':{'maxsize':'2.047em',
                                         'minsize':'2.047em'}}],
                        'attributes':{}}],
                     'attributes':{},
                     'TeXAtom':'CLOSE'},
	            {'type':'mrow',
                     'children':[
	               {'type':'mrow',
                        'inferred':true,
                        'children':[
	                  {'type':'mo',
                           'text':')',
                           'attributes':{'maxsize':'1.2em',
                                         'minsize':'1.2em'}}],
                        'attributes':{}}],
                     'attributes':{},
                     'TeXAtom':'CLOSE'},
	            {'type':'mrow',
                     'children':[
	               {'type':'mrow',
                        'inferred':true,
                        'children':[
	                  {'type':'mo',
                           'text':')',
                           'attributes':{'maxsize':'1.2em',
                                         'minsize':'1.2em'}}],
                        'attributes':{}}],
                     'attributes':{},
                     'TeXAtom':'CLOSE'},
	            {'type':'mrow',
                     'children':[
	               {'type':'mrow',
                        'inferred':true,
                        'children':[
	                  {'type':'mo',
                           'text':')',
                           'attributes':{'maxsize':'1.2em',
                                         'minsize':'1.2em'}}],
                        'attributes':{}}],
                     'attributes':{},
                     'TeXAtom':'CLOSE'}],
                  'attributes':{}}],
               'attributes':{}}],
            'attributes':{}}],
         'attributes':{},
         'TeXAtom':'ORD'},
	{'type':'msup',
         'children':[
	   {'type':'mi',
            'text':'p',
            'attributes':{}},
	   {'type':'mi',
            'text':'k',
            'attributes':{}}],
         'attributes':{}},
	{'type':'mo',
         'text':'(',
         'attributes':{'stretchy':false}},
	{'type':'mn',
         'text':'1',
         'attributes':{}},
	{'type':'mo',
         'text':'−',
         'attributes':{}},
	{'type':'mi',
         'text':'p',
         'attributes':{}},
	{'type':'msup',
         'children':[
	   {'type':'mo',
            'text':')',
            'attributes':{'stretchy':false}},
	   {'type':'mrow',
            'children':[
	      {'type':'mrow',
               'inferred':true,
               'children':[
	         {'type':'mi',
                  'text':'n',
                  'attributes':{}},
	         {'type':'mo',
                  'text':'−',
                  'attributes':{}},
	         {'type':'mi',
                  'text':'k',
                  'attributes':{}}],
               'attributes':{}}],
            'attributes':{},
            'TeXAtom':'ORD'}],
         'attributes':{}}],
      'attributes':{}}],
   'attributes':{'display':'block'}});


treeTest.amsTest(
  'Maxwell\'s Equations',
  {'type':'math',
   'children':[
     {'type':'mrow',
      'inferred':true,
      'children':[
	{'type':'mtable',
         'children':[
	   {'type':'mtr',
            'children':[
	      {'type':'mtd',
               'children':[
	         {'type':'mrow',
                  'inferred':true,
                  'children':[
	            {'type':'mi',
                     'text':'∇',
                     'attributes':{'mathvariant':'normal'}},
	            {'type':'mo',
                     'text':'×',
                     'attributes':{}},
	            {'type':'mrow',
                     'children':[
	               {'type':'mrow',
                        'inferred':true,
                        'children':[
	                  {'type':'mover',
                           'children':[
	                     {'type':'mrow',
                              'children':[
	                        {'type':'mrow',
                                 'inferred':true,
                                 'children':[
	                           {'type':'mi',
                                    'text':'B',
                                    'attributes':{'mathvariant':'bold'}}],
                                 'attributes':{}}],
                              'attributes':{},
                              'TeXAtom':'ORD'},
	                     {'type':'mo',
                              'text':'→',
                              'attributes':{'stretchy':false}}],
                           'attributes':{}}],
                        'attributes':{}}],
                     'attributes':{},
                     'TeXAtom':'ORD'},
	            {'type':'mo',
                     'text':'−',
                     'attributes':{}},
	            {'type':'mspace',
                     'text':'',
                     'attributes':{'width':'thinmathspace'}},
	            {'type':'mfrac',
                     'children':[
	               {'type':'mn',
                        'text':'1',
                        'attributes':{}},
	               {'type':'mi',
                        'text':'c',
                        'attributes':{}}],
                     'attributes':{}},
	            {'type':'mspace',
                     'text':'',
                     'attributes':{'width':'thinmathspace'}},
	            {'type':'mfrac',
                     'children':[
	               {'type':'mrow',
                        'inferred':true,
                        'children':[
	                  {'type':'mi',
                           'text':'∂',
                           'attributes':{'mathvariant':'normal'}},
	                  {'type':'mrow',
                           'children':[
	                     {'type':'mrow',
                              'inferred':true,
                              'children':[
	                        {'type':'mover',
                                 'children':[
	                           {'type':'mrow',
                                    'children':[
	                              {'type':'mrow',
                                       'inferred':true,
                                       'children':[
	                                 {'type':'mi',
                                          'text':'E',
                                          'attributes':{'mathvariant':'bold'}}],
                                       'attributes':{}}],
                                    'attributes':{},
                                    'TeXAtom':'ORD'},
	                           {'type':'mo',
                                    'text':'→',
                                    'attributes':{'stretchy':false}}],
                                 'attributes':{}}],
                              'attributes':{}}],
                           'attributes':{},
                           'TeXAtom':'ORD'}],
                        'attributes':{}},
	               {'type':'mrow',
                        'inferred':true,
                        'children':[
	                  {'type':'mi',
                           'text':'∂',
                           'attributes':{'mathvariant':'normal'}},
	                  {'type':'mi',
                           'text':'t',
                           'attributes':{}}],
                        'attributes':{}}],
                     'attributes':{}}],
                  'attributes':{}}],
               'attributes':{}},
	      {'type':'mtd',
               'children':[
	         {'type':'mrow',
                  'inferred':true,
                  'children':[
	            {'type':'mi',
                     'text':'',
                     'attributes':{}},
	            {'type':'mo',
                     'text':'=',
                     'attributes':{}},
	            {'type':'mfrac',
                     'children':[
	               {'type':'mrow',
                        'inferred':true,
                        'children':[
	                  {'type':'mn',
                           'text':'4',
                           'attributes':{}},
	                  {'type':'mi',
                           'text':'π',
                           'attributes':{}}],
                        'attributes':{}},
	               {'type':'mi',
                        'text':'c',
                        'attributes':{}}],
                     'attributes':{}},
	            {'type':'mrow',
                     'children':[
	               {'type':'mrow',
                        'inferred':true,
                        'children':[
	                  {'type':'mover',
                           'children':[
	                     {'type':'mrow',
                              'children':[
	                        {'type':'mrow',
                                 'inferred':true,
                                 'children':[
	                           {'type':'mi',
                                    'text':'j',
                                    'attributes':{'mathvariant':'bold'}}],
                                 'attributes':{}}],
                              'attributes':{},
                              'TeXAtom':'ORD'},
	                     {'type':'mo',
                              'text':'→',
                              'attributes':{'stretchy':false}}],
                           'attributes':{}}],
                        'attributes':{}}],
                     'attributes':{},
                     'TeXAtom':'ORD'}],
                  'attributes':{}}],
               'attributes':{}}],
            'attributes':{}},
	   {'type':'mtr',
            'children':[
	      {'type':'mtd',
               'children':[
	         {'type':'mrow',
                  'inferred':true,
                  'children':[
	            {'type':'mi',
                     'text':'∇',
                     'attributes':{'mathvariant':'normal'}},
	            {'type':'mo',
                     'text':'⋅',
                     'attributes':{}},
	            {'type':'mrow',
                     'children':[
	               {'type':'mrow',
                        'inferred':true,
                        'children':[
	                  {'type':'mover',
                           'children':[
	                     {'type':'mrow',
                              'children':[
	                        {'type':'mrow',
                                 'inferred':true,
                                 'children':[
	                           {'type':'mi',
                                    'text':'E',
                                    'attributes':{'mathvariant':'bold'}}],
                                 'attributes':{}}],
                              'attributes':{},
                              'TeXAtom':'ORD'},
	                     {'type':'mo',
                              'text':'→',
                              'attributes':{'stretchy':false}}],
                           'attributes':{}}],
                        'attributes':{}}],
                     'attributes':{},
                     'TeXAtom':'ORD'}],
                  'attributes':{}}],
               'attributes':{}},
	      {'type':'mtd',
               'children':[
	         {'type':'mrow',
                  'inferred':true,
                  'children':[
	            {'type':'mi',
                     'text':'',
                     'attributes':{}},
	            {'type':'mo',
                     'text':'=',
                     'attributes':{}},
	            {'type':'mn',
                     'text':'4',
                     'attributes':{}},
	            {'type':'mi',
                     'text':'π',
                     'attributes':{}},
	            {'type':'mi',
                     'text':'ρ',
                     'attributes':{}}],
                  'attributes':{}}],
               'attributes':{}}],
            'attributes':{}},
	   {'type':'mtr',
            'children':[
	      {'type':'mtd',
               'children':[
	         {'type':'mrow',
                  'inferred':true,
                  'children':[
	            {'type':'mi',
                     'text':'∇',
                     'attributes':{'mathvariant':'normal'}},
	            {'type':'mo',
                     'text':'×',
                     'attributes':{}},
	            {'type':'mrow',
                     'children':[
	               {'type':'mrow',
                        'inferred':true,
                        'children':[
	                  {'type':'mover',
                           'children':[
	                     {'type':'mrow',
                              'children':[
	                        {'type':'mrow',
                                 'inferred':true,
                                 'children':[
	                           {'type':'mi',
                                    'text':'E',
                                    'attributes':{'mathvariant':'bold'}}],
                                 'attributes':{}}],
                              'attributes':{},
                              'TeXAtom':'ORD'},
	                     {'type':'mo',
                              'text':'→',
                              'attributes':{'stretchy':false}}],
                           'attributes':{}}],
                        'attributes':{}}],
                     'attributes':{},
                     'TeXAtom':'ORD'},
	            {'type':'mspace',
                     'text':'',
                     'attributes':{'width':'thinmathspace'}},
	            {'type':'mo',
                     'text':'+',
                     'attributes':{}},
	            {'type':'mspace',
                     'text':'',
                     'attributes':{'width':'thinmathspace'}},
	            {'type':'mfrac',
                     'children':[
	               {'type':'mn',
                        'text':'1',
                        'attributes':{}},
	               {'type':'mi',
                        'text':'c',
                        'attributes':{}}],
                     'attributes':{}},
	            {'type':'mspace',
                     'text':'',
                     'attributes':{'width':'thinmathspace'}},
	            {'type':'mfrac',
                     'children':[
	               {'type':'mrow',
                        'inferred':true,
                        'children':[
	                  {'type':'mi',
                           'text':'∂',
                           'attributes':{'mathvariant':'normal'}},
	                  {'type':'mrow',
                           'children':[
	                     {'type':'mrow',
                              'inferred':true,
                              'children':[
	                        {'type':'mover',
                                 'children':[
	                           {'type':'mrow',
                                    'children':[
	                              {'type':'mrow',
                                       'inferred':true,
                                       'children':[
	                                 {'type':'mi',
                                          'text':'B',
                                          'attributes':{'mathvariant':'bold'}}],
                                       'attributes':{}}],
                                    'attributes':{},
                                    'TeXAtom':'ORD'},
	                           {'type':'mo',
                                    'text':'→',
                                    'attributes':{'stretchy':false}}],
                                 'attributes':{}}],
                              'attributes':{}}],
                           'attributes':{},
                           'TeXAtom':'ORD'}],
                        'attributes':{}},
	               {'type':'mrow',
                        'inferred':true,
                        'children':[
	                  {'type':'mi',
                           'text':'∂',
                           'attributes':{'mathvariant':'normal'}},
	                  {'type':'mi',
                           'text':'t',
                           'attributes':{}}],
                        'attributes':{}}],
                     'attributes':{}}],
                  'attributes':{}}],
               'attributes':{}},
	      {'type':'mtd',
               'children':[
	         {'type':'mrow',
                  'inferred':true,
                  'children':[
	            {'type':'mi',
                     'text':'',
                     'attributes':{}},
	            {'type':'mo',
                     'text':'=',
                     'attributes':{}},
	            {'type':'mrow',
                     'children':[
	               {'type':'mrow',
                        'inferred':true,
                        'children':[
	                  {'type':'mover',
                           'children':[
	                     {'type':'mrow',
                              'children':[
	                        {'type':'mrow',
                                 'inferred':true,
                                 'children':[
	                           {'type':'mn',
                                    'text':'0',
                                    'attributes':{'mathvariant':'bold'}}],
                                 'attributes':{}}],
                              'attributes':{},
                              'TeXAtom':'ORD'},
	                     {'type':'mo',
                              'text':'→',
                              'attributes':{'stretchy':false}}],
                           'attributes':{}}],
                        'attributes':{}}],
                     'attributes':{},
                     'TeXAtom':'ORD'}],
                  'attributes':{}}],
               'attributes':{}}],
            'attributes':{}},
	   {'type':'mtr',
            'children':[
	      {'type':'mtd',
               'children':[
	         {'type':'mrow',
                  'inferred':true,
                  'children':[
	            {'type':'mi',
                     'text':'∇',
                     'attributes':{'mathvariant':'normal'}},
	            {'type':'mo',
                     'text':'⋅',
                     'attributes':{}},
	            {'type':'mrow',
                     'children':[
	               {'type':'mrow',
                        'inferred':true,
                        'children':[
	                  {'type':'mover',
                           'children':[
	                     {'type':'mrow',
                              'children':[
	                        {'type':'mrow',
                                 'inferred':true,
                                 'children':[
	                           {'type':'mi',
                                    'text':'B',
                                    'attributes':{'mathvariant':'bold'}}],
                                 'attributes':{}}],
                              'attributes':{},
                              'TeXAtom':'ORD'},
	                     {'type':'mo',
                              'text':'→',
                              'attributes':{'stretchy':false}}],
                           'attributes':{}}],
                        'attributes':{}}],
                     'attributes':{},
                     'TeXAtom':'ORD'}],
                  'attributes':{}}],
               'attributes':{}},
	      {'type':'mtd',
               'children':[
	         {'type':'mrow',
                  'inferred':true,
                  'children':[
	            {'type':'mi',
                     'text':'',
                     'attributes':{}},
	            {'type':'mo',
                     'text':'=',
                     'attributes':{}},
	            {'type':'mn',
                     'text':'0',
                     'attributes':{}}],
                  'attributes':{}}],
               'attributes':{}}],
            'attributes':{}}],
         'attributes':{
           'columnalign':'right left right left right left right left right' +
             ' left right left',
           'rowspacing':'3pt',
           'columnspacing':'0em 2em 0em 2em 0em 2em 0em 2em 0em 2em 0em',
                       'displaystyle':true}}],
      'attributes':{}}],
   'attributes':{'display':'block'}});


treeTest.runTest(
  'Color Frac',
  {'type':'math',
   'children':[
     {'type':'mrow',
      'inferred':true,
      'children':[
	{'type':'mfrac',
	 'children':[
	   {'type':'mrow',
	    'children':[
	      {'type':'mrow',
	       'inferred':true,
	       'children':[
	         {'type':'mstyle',
	          'children':[
	            {'type':'mrow',
	             'inferred':true,
	             'children':[
	               {'type':'mi',
	                'text':'X',
	                'attributes':{'mathvariant':'-tex-caligraphic'}}],
	             'attributes':{}}],
	          'attributes':{'mathcolor':'red'}}],
	       'attributes':{}}],
	    'attributes':{},
	    'TeXAtom':'ORD'},
	   {'type':'mstyle',
	    'children':[
	      {'type':'mrow',
	       'inferred':true,
	       'children':[
	         {'type':'mi',
	          'text':'y',
	          'attributes':{'mathvariant':'sans-serif'}}],
	       'attributes':{}}],
	    'attributes':{'mathcolor':'blue'}}],
	 'attributes':{}}],
      'attributes':{}}],
   'attributes':{'display':'block'}}
);


treeTest.runTest(
  'Cubic Binomial',
  {'type':'math',
   'children':[
     {'type':'mrow',
      'inferred':true,
      'children':[
	{'type':'mrow',
	 'children':[
	   {'type':'mrow',
	    'inferred':true,
	    'children':[
	      {'type':'mtable',
	       'children':[
	         {'type':'mtr',
	          'children':[
	            {'type':'mtd',
	             'children':[
	               {'type':'mrow',
	                'inferred':true,
	                'children':[
	                  {'type':'mo',
	                   'text':'(',
	                   'attributes':{'stretchy':false}},
	                  {'type':'mi',
	                   'text':'x',
	                   'attributes':{}},
	                  {'type':'mo',
	                   'text':'+',
	                   'attributes':{}},
	                  {'type':'mi',
	                   'text':'y',
	                   'attributes':{}},
	                  {'type':'msup',
	                   'children':[
	                     {'type':'mo',
	                      'text':')',
	                      'attributes':{'stretchy':false}},
	                     {'type':'mrow',
	                      'children':[
	                        {'type':'mrow',
	                         'inferred':true,
	                         'children':[
	                           {'type':'mn',
	                            'text':'3',
	                            'attributes':{}}],
	                         'attributes':{}}],
	                      'attributes':{},
	                      'TeXAtom':'ORD'}],
	                   'attributes':{}}],
	                'attributes':{}}],
	             'attributes':{}},
	            {'type':'mtd',
	             'children':[
	               {'type':'mrow',
	                'inferred':true,
	                'children':[
	                  {'type':'mi',
	                   'text':'',
	                   'attributes':{}},
	                  {'type':'mo',
	                   'text':'=',
	                   'attributes':{}}],
	                'attributes':{}}],
	             'attributes':{}},
	            {'type':'mtd',
	             'children':[
	               {'type':'mrow',
	                'inferred':true,
	                'children':[
	                  {'type':'mi',
	                   'text':'',
	                   'attributes':{}},
	                  {'type':'mo',
	                   'text':'(',
	                   'attributes':{'stretchy':false}},
	                  {'type':'mi',
	                   'text':'x',
	                   'attributes':{}},
	                  {'type':'mo',
	                   'text':'+',
	                   'attributes':{}},
	                  {'type':'mi',
	                   'text':'y',
	                   'attributes':{}},
	                  {'type':'mo',
	                   'text':')',
	                   'attributes':{'stretchy':false}},
	                  {'type':'mo',
	                   'text':'(',
	                   'attributes':{'stretchy':false}},
	                  {'type':'mi',
	                   'text':'x',
	                   'attributes':{}},
	                  {'type':'mo',
	                   'text':'+',
	                   'attributes':{}},
	                  {'type':'mi',
	                   'text':'y',
	                   'attributes':{}},
	                  {'type':'mo',
	                   'text':')',
	                   'attributes':{'stretchy':false}},
	                  {'type':'mo',
	                   'text':'(',
	                   'attributes':{'stretchy':false}},
	                  {'type':'mi',
	                   'text':'x',
	                   'attributes':{}},
	                  {'type':'mo',
	                   'text':'+',
	                   'attributes':{}},
	                  {'type':'mi',
	                   'text':'y',
	                   'attributes':{}},
	                  {'type':'mo',
	                   'text':')',
	                   'attributes':{'stretchy':false}}],
	                'attributes':{}}],
	             'attributes':{}}],
	          'attributes':{}},
	         {'type':'mtr',
	          'children':[
	            {'type':'mtd',
	             'children':[
	               {'type':'mrow',
	                'inferred':true,
	                'attributes':{}}],
	             'attributes':{}},
	            {'type':'mtd',
	             'children':[
	               {'type':'mrow',
	                'inferred':true,
	                'children':[
	                  {'type':'mi',
	                   'text':'',
	                   'attributes':{}},
	                  {'type':'mo',
	                   'text':'=',
	                   'attributes':{}}],
	                'attributes':{}}],
	             'attributes':{}},
	            {'type':'mtd',
	             'children':[
	               {'type':'mrow',
	                'inferred':true,
	                'children':[
	                  {'type':'msup',
	                   'children':[
	                     {'type':'mi',
	                      'text':'x',
	                      'attributes':{}},
	                     {'type':'mrow',
	                      'children':[
	                        {'type':'mrow',
	                         'inferred':true,
	                         'children':[
	                           {'type':'mn',
	                            'text':'3',
	                            'attributes':{}}],
	                         'attributes':{}}],
	                      'attributes':{},
	                      'TeXAtom':'ORD'}],
	                   'attributes':{}},
	                  {'type':'mo',
	                   'text':'+',
	                   'attributes':{}},
	                  {'type':'mn',
	                   'text':'3',
	                   'attributes':{}},
	                  {'type':'msup',
	                   'children':[
	                     {'type':'mi',
	                      'text':'x',
	                      'attributes':{}},
	                     {'type':'mrow',
	                      'children':[
	                        {'type':'mrow',
	                         'inferred':true,
	                         'children':[
	                           {'type':'mn',
	                            'text':'2',
	                            'attributes':{}}],
	                         'attributes':{}}],
	                      'attributes':{},
	                      'TeXAtom':'ORD'}],
	                   'attributes':{}},
	                  {'type':'mi',
	                   'text':'y',
	                   'attributes':{}},
	                  {'type':'mo',
	                   'text':'+',
	                   'attributes':{}},
	                  {'type':'mrow',
	                   'children':[
	                     {'type':'mrow',
	                      'inferred':true,
	                      'children':[
	                        {'type':'munder',
	                         'children':[
	                           {'type':'mrow',
	                            'inferred':true,
	                            'children':[
	                              {'type':'mn',
	                               'text':'3',
	                               'attributes':{}},
	                              {'type':'mi',
	                               'text':'x',
	                               'attributes':{}},
	                              {'type':'msup',
	                               'children':[
	                                 {'type':'mi',
	                                  'text':'y',
	                                  'attributes':{}},
	                                 {'type':'mrow',
	                                  'children':[
	                                    {'type':'mrow',
	                                     'inferred':true,
	                                     'children':[
	                                       {'type':'mn',
	                                        'text':'2',
	                                        'attributes':{}}],
	                                     'attributes':{}}],
	                                  'attributes':{},
	                                  'TeXAtom':'ORD'}],
	                               'attributes':{}}],
	                            'attributes':{}},
	                           {'type':'mo',
	                            'text':'_',
	                            'attributes':{}}],
	                         'attributes':{}}],
	                      'attributes':{}}],
	                   'attributes':{},
	                   'TeXAtom':'ORD'},
	                  {'type':'mo',
	                   'text':'+',
	                   'attributes':{}},
	                  {'type':'msup',
	                   'children':[
	                     {'type':'mi',
	                      'text':'y',
	                      'attributes':{}},
	                     {'type':'mrow',
	                      'children':[
	                        {'type':'mrow',
	                         'inferred':true,
	                         'children':[
	                           {'type':'mn',
	                            'text':'3',
	                            'attributes':{}}],
	                         'attributes':{}}],
	                      'attributes':{},
	                      'TeXAtom':'ORD'}],
	                   'attributes':{}},
	                  {'type':'mo',
	                   'text':'.',
	                   'attributes':{}}],
	                'attributes':{}}],
	             'attributes':{}}],
	          'attributes':{}}],
	       'attributes':{'columnalign':'right center left',
	                     'rowspacing':'3pt',
	                     'columnspacing':'0 thickmathspace',
	                     'displaystyle':true}}],
	    'attributes':{}}],
	 'attributes':{},
	 'TeXAtom':'ORD'}],
      'attributes':{}}],
   'attributes':{'display':'block'}}
);

// Currently ignored tests use AMS math stuff.

treeTest.printTime();
